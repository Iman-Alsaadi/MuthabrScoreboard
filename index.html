<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>/Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø­Ø¯ÙŠØ¯ÙŠØ©</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      background: url('background1.png') no-repeat center center fixed;
  background-size: cover;
      padding: 20px;
      color: white;
    }

    h1 {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .teams {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .team {
      background: #835DFF;
      border-radius: 15px;
      padding: 20px;
      width: 220px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .team-header {
      background: #6F49D9;
      border-radius: 12px;
      width: 100%;
      padding: 10px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .team-header input {
      font-size: 20px;
      font-weight: bold;
      background: transparent;
      border: none;
      color: #fff;
      text-align: center;
      width: 100px;
    }

    .rank-name {
      font-size: 20px;
      font-weight: bold;
      user-select: none;
    }

    .score {
      font-size: 40px;
      font-weight: bold;
      margin-top: 10px;
    }

    .stars {
      font-size: 24px;
      color: #FFAE00;
      margin: 8px 0;
    }

    .buttons {
      display: flex;
      gap: 10px;
    }

    button {
      font-size: 18px;
      padding: 6px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background-color: #E0D7FF;
      color: #532EC9;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #C5B8FF;
    }

    #timer {
      font-size: 50px;
      margin: 30px auto;
      color: #532EC9;
      background: #E0D7FF;
      width: 160px;
      padding: 15px;
      border-radius: 10px;
      font-weight: bold;
    }

    #controls {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    #questionNumber {
      display: none;
      font-size: 26px;
      color: #532EC9;
      background: #fffbe6;
      border: 3px solid #FFAE00;
      border-radius: 12px;
      padding: 12px;
      width: fit-content;
      margin: 0 auto 15px auto;
      font-weight: bold;
    }

    .rank-img {
      width: 60px;
      height: 60px;
      object-fit: contain;
      margin-bottom: 8px;
    }

    .winner {
      border: 4px solid gold;
      box-shadow: 0 0 20px gold;
      transform: scale(1.05);
    }

  </style>
</head>
<body>
  <h1>Ù…Ø³Ø§Ø¨Ù‚Ø© "Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø­Ø¯ÙŠØ¯ÙŠØ©"</h1>

  <div id="setup" style="margin: 20px 0;">
  <label for="teamCount" style="font-size: 20px;">Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±Ù‚:</label>
  <select id="teamCount" style="font-size: 18px; padding: 6px; border: none; border-radius: 6px; cursor: pointer;
      background-color: #E0D7FF; color: #532EC9; font-weight: bold; transition: background-color 0.3s;">
    <option value="1">1 ÙØ±ÙŠÙ‚</option>
    <option value="2">2 ÙØ±ÙŠÙ‚Ø§Ù†</option>
    <option value="3">3 ÙØ±Ù‚</option>
    <option value="4" selected>4 ÙØ±Ù‚</option>
    <option value="5">5 ÙØ±Ù‚</option>
    <option value="6">6 ÙØ±Ù‚</option>
    <option value="7">7 ÙØ±Ù‚</option>
    <option value="8">8 ÙØ±Ù‚</option>
    <option value="9">9 ÙØ±Ù‚</option>
    <option value="10">10 ÙØ±Ù‚</option>
  </select>
  <button onclick="initializeTeams()" style="font-size: 18px; padding: 6px 12px;">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</button>
  </div>


  <div id="questionNumber"></div>
  <div id="timer">300</div>

  <div id="controls">
    <button onclick="restartPhases()">Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</button>
    <button onclick="prevPhase()">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</button>
    <button onclick="nextPhase()">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©</button>
    <button onclick="startPhase()" id="startPhase">Ø§Ø¨Ø¯Ø£ Ø§Ù„ÙˆÙ‚Øª</button>
    <button onclick="nextQuestion()" id="nextBtn" style="display:none;">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
  </div>

  <div class="teams">
    <!-- ÙØ±Ù‚ 1 Ø¥Ù„Ù‰ 4 -->
    <div class="team" data-team="1">
      <div class="team-header">
        <img id="rankImage1" class="rank-img" src="Ù…Ø¨ØªØ¯Ø¦.png" alt="Ø§Ù„Ø±ØªØ¨Ø©">
        <input id="name1" value="ÙØ±ÙŠÙ‚ 1">
        <span class="rank-name" id="rankName1"><span class="rank-text">Ù…Ø¨ØªØ¯Ø¦</span></span>
      </div>
      <div class="score" id="score1">0</div>
      <div class="stars" id="stars1"></div>
      <div class="buttons">
        <button onclick="addPoint(1)">+</button>
        <button onclick="removePoint(1)">-</button>
      </div>
    </div>

    <div class="team" data-team="2">
      <div class="team-header">
        <img id="rankImage2" class="rank-img" src="Ù…Ø¨ØªØ¯Ø¦.png" alt="Ø§Ù„Ø±ØªØ¨Ø©">
        <input id="name2" value="ÙØ±ÙŠÙ‚ 2">
        <span class="rank-name" id="rankName2"><span class="rank-text">Ù…Ø¨ØªØ¯Ø¦</span></span>
      </div>
      <div class="score" id="score2">0</div>
      <div class="stars" id="stars2"></div>
      <div class="buttons">
        <button onclick="addPoint(2)">+</button>
        <button onclick="removePoint(2)">-</button>
      </div>
    </div>

    <div class="team" data-team="3">
      <div class="team-header">
        <img id="rankImage3" class="rank-img" src="Ù…Ø¨ØªØ¯Ø¦.png" alt="Ø§Ù„Ø±ØªØ¨Ø©">
        <input id="name3" value="ÙØ±ÙŠÙ‚ 3">
        <span class="rank-name" id="rankName3"><span class="rank-text">Ù…Ø¨ØªØ¯Ø¦</span></span>
      </div>
      <div class="score" id="score3">0</div>
      <div class="stars" id="stars3"></div>
      <div class="buttons">
        <button onclick="addPoint(3)">+</button>
        <button onclick="removePoint(3)">-</button>
      </div>
    </div>

    <div class="team" data-team="4">
      <div class="team-header">
        <img id="rankImage4" class="rank-img" src="Ù…Ø¨ØªØ¯Ø¦.png" alt="Ø§Ù„Ø±ØªØ¨Ø©">
        <input id="name4" value="ÙØ±ÙŠÙ‚ 4">
        <span class="rank-name" id="rankName4"><span class="rank-text">Ù…Ø¨ØªØ¯Ø¦</span></span>
      </div>
      <div class="score" id="score4">0</div>
      <div class="stars" id="stars4"></div>
      <div class="buttons">
        <button onclick="addPoint(4)">+</button>
        <button onclick="removePoint(4)">-</button>
      </div>
    </div>
  </div>

  <audio id="bell" src="bell.mp3" preload="auto"></audio>
  <audio id="tick" src="tick.mp3" preload="auto"></audio>

  <script>
    let phase = 1, question = 0, interval = null;
    let scores = [];

    function playBell() {
      document.getElementById('bell').play();
    }

    function getRank(score) {
      if (score >= 25) return ['Ø£Ø³Ø·ÙˆØ±Ø©','ğŸŒŸ'];
      if (score >= 15) return ['Ù…ÙØ«Ø§Ø¨Ø±','ğŸ”¥'];
      if (score >= 10) return ['Ù…Ø¬ØªÙ‡Ø¯','ğŸ’ª'];
      if (score >= 5)  return ['Ù†Ø¬Ù… ØµØ§Ø¹Ø¯','â­'];
      return ['Ù…Ø¨ØªØ¯Ø¦','âœ°'];
    }

    function updateScore(team) {
      const idx = team - 1;
      const [name, icon] = getRank(scores[idx]);
      document.getElementById('score' + team).textContent = scores[idx];
      document.getElementById('stars' + team).textContent = 'â­'.repeat(Math.min(scores[idx], 5));
      document.querySelector('#rankName' + team + ' .rank-text').textContent = name;
      document.getElementById('rankImage' + team).src = `${name}.png`;
      document.getElementById('rankImage' + team).alt = name;
    }

    function addPoint(t) { scores[t-1]++; updateScore(t); }
    function removePoint(t) { if (scores[t-1]>0) { scores[t-1]--; updateScore(t); } }

   function restartPhases() {
      clearInterval(interval);
      phase = 1;
      question = 0;

      document.getElementById('timer').style.display = 'block';
      document.getElementById('timer').textContent = 300;
      document.getElementById('questionNumber').style.display = 'block';

      document.querySelectorAll('#controls button').forEach(btn => btn.style.display = 'inline-block');
      document.getElementById('nextBtn').style.display = 'none';

      showPhaseCard();
    }

    function prevPhase() {
      if (phase > 1) {
        phase--;
        question = 0;
        clearInterval(interval);
        document.getElementById('nextBtn').style.display = 'none';
        showPhaseCard();
      }
    }

    function startPhase() {
      clearInterval(interval);
      hideButtons();
      if (phase === 1) {
        startTimer(300, () => { phase = 2; question = 0; showPhaseCard(); });
      } else if (phase === 2 || phase === 3) {
        document.getElementById('nextBtn').style.display = 'inline-block';
        if (question > 0) {
          document.getElementById('questionNumber').textContent = phase === 2 ?
            `ğŸ“˜ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ø³ØªØ°ÙƒØ§Ø± - Ø³Ø¤Ø§Ù„ ${question}` :
            `ğŸ“— Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ - Ø³Ø¤Ø§Ù„ ${question}`;
          startTimer(15);
        }
      }
    }

    function nextQuestion() {
      clearInterval(interval);
      if (question < 5) {
        question++;
        document.getElementById('questionNumber').textContent = phase === 2 ?
          `ğŸ“˜ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ø³ØªØ°ÙƒØ§Ø± - Ø³Ø¤Ø§Ù„ ${question}` :
          `ğŸ“— Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ - Ø³Ø¤Ø§Ù„ ${question}`;
      } else {
        document.getElementById('nextBtn').style.display = 'none';
      }
    }

    function nextPhase() {
      clearInterval(interval);
      document.getElementById('tick').pause();
      document.getElementById('tick').currentTime = 0;
      question = 0;
      phase = Math.min(phase + 1, 4);
      hideButtons();
      showPhaseCard();
    }

    function hideButtons() {
      document.getElementById('nextBtn').style.display = 'none';
    }

    function showPhaseCard() {
      const q = document.getElementById('questionNumber');
      q.style.display = 'block';

      if (phase === 1) {
        q.textContent = 'ğŸ“ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ø®Øµ';
        timer.textContent = 300;
        document.getElementById('startPhase').style.display = 'inline-block';
      } else if (phase === 2) {
        q.textContent = 'ğŸ“˜ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ø³ØªØ°ÙƒØ§Ø±';
        timer.textContent = 15;
        document.getElementById('nextBtn').style.display = 'inline-block';
      } else if (phase === 3) {
        q.textContent = 'ğŸ“— Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù…Ù† Ù…ØªØ¹Ø¯Ø¯';
        timer.textContent = 15;
        document.getElementById('nextBtn').style.display = 'inline-block';
      } else {
        q.textContent = 'ğŸ‘ Ø£Ø­Ø³Ù†ØªÙ… Ø¬Ù…ÙŠØ¹Ù‹Ø§!';
        highlightWinnersAndSort();
        document.getElementById('timer').style.display = 'none';
        document.getElementById('nextBtn').style.display = 'none';
        document.querySelectorAll('#controls button').forEach(btn => btn.style.display = 'none');
        document.querySelector('#controls button:first-child').style.display = 'inline-block';
      }
    }

    function startTimer(sec, cb) {
      clearInterval(interval);
      const tickSound = document.getElementById('tick');
      document.getElementById('timer').textContent = sec;

      interval = setInterval(() => {
        document.getElementById('timer').textContent = sec;

        if (sec <= 0) {
          clearInterval(interval);
          tickSound.pause();
          tickSound.currentTime = 0;
          playBell();
          if (cb) cb();
          return;
        }

        tickSound.pause();
        tickSound.currentTime = 0;
        tickSound.play();

        sec--;
      }, 1000);
    }

    document.addEventListener('DOMContentLoaded', restartPhases);

    function highlightWinnersAndSort() {
  const teamsContainer = document.querySelector('.teams');
  const teamElements = Array.from(teamsContainer.children);

  // Ø¬Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø§Ø· Ù„ÙƒÙ„ ÙØ±ÙŠÙ‚
  const teamData = teamElements.map(el => {
    const teamNum = el.getAttribute('data-team');
    const score = scores[teamNum - 1];
    return { el, score };
  });

  // Ø¥ÙŠØ¬Ø§Ø¯ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·
  const maxScore = Math.max(...teamData.map(t => t.score));

  // Ø¥Ø²Ø§Ù„Ø© ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙÙˆØ² Ø§Ù„Ø³Ø§Ø¨Ù‚
  teamData.forEach(t => t.el.classList.remove('winner'));

  // ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ø­Ø§ØµÙ„Ø© Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·
  teamData.forEach(t => {
    if (t.score === maxScore && maxScore > 0) {
      t.el.classList.add('winner');
    }
  });

  // ØªØ±ØªÙŠØ¨ Ø§Ù„ÙØ±Ù‚ ØªÙ†Ø§Ø²Ù„ÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·
  teamData.sort((a, b) => b.score - a.score);

  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„ØµÙØ­Ø©
  teamData.forEach(t => teamsContainer.appendChild(t.el));
}

  function initializeTeams() {
  const count = parseInt(document.getElementById('teamCount').value);
  const teamsContainer = document.querySelector('.teams');
  teamsContainer.innerHTML = ''; // Ø­Ø°Ù Ø£ÙŠ ÙØ±Ù‚ Ø³Ø§Ø¨Ù‚Ø©

  scores.length = 0; // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ù‚Ø§Ø·

  for (let i = 1; i <= count; i++) {
    scores.push(0); // Ù†Ù‚Ø·Ø© Ø£ÙˆÙ„ÙŠØ© Ù„ÙƒÙ„ ÙØ±ÙŠÙ‚

    const team = document.createElement('div');
    team.className = 'team';
    team.setAttribute('data-team', i);
    team.innerHTML = `
      <div class="team-header">
        <img id="rankImage${i}" class="rank-img" src="Ù…Ø¨ØªØ¯Ø¦.png" alt="Ø§Ù„Ø±ØªØ¨Ø©">
        <input id="name${i}" value="ÙØ±ÙŠÙ‚ ${i}">
        <span class="rank-name" id="rankName${i}"><span class="rank-text">Ù…Ø¨ØªØ¯Ø¦</span></span>
      </div>
      <div class="score" id="score${i}">0</div>
      <div class="stars" id="stars${i}"></div>
      <div class="buttons">
        <button onclick="addPoint(${i})">+</button>
        <button onclick="removePoint(${i})">-</button>
      </div>
    `;
    teamsContainer.appendChild(team);
  }

  document.getElementById('setup').style.display = 'none'; // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  document.getElementById('controls').style.display = 'flex'; // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
  document.getElementById('questionNumber').style.display = 'block';

  restartPhases(); // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ø­Ù„
}


  </script>
</body>
</html>
